<title>记录一览表</title>
<div class="layui-card layadmin-header">
	<div class="layui-breadcrumb" lay-filter="breadcrumb">
		<a lay-href="">报表中心</a>
		<a><cite>记录一览表</cite></a>
	</div>
</div>

<div class="layui-fluid" style="background-color: #fff!important;">
	<div class="layui-form  layuiadmin-card-header-auto" lay-filter="app-content-list">
		<div class="layui-tab layui-tab-card" lay-filter="">
			<ul class="layui-tab-title">
				<li data-status="" class="layui-this">培训记录</li>
				<li data-status="1">讲师相关</li>
			</ul>
			<div class="layui-tab-content">

				<!--培训记录-->
				<div class="layui-tab-item layui-show">
					<div class="layui-form-item">
						<div class="layui-inline">
							<button class="layui-btn layuiadmin-btn-list">查询信息</button>
						</div>
					</div>

					<div class="layui-form-item">
						<div class="layui-inline">
							<label class="layui-form-label">课程类型</label>
							<div class="layui-input-inline">
								<select name="courseType" lay-search="" id="courseType" lay-filter="courseType" class="layui-form">
									<option value="">--所有--</option>
								</select>
							</div>
						</div>
						<div class="layui-inline">
							<label class="layui-form-label">课程属性</label>
							<div class="layui-input-inline">
								<select name="courseAttrId" lay-verify="" lay-search="">
									<option value="">--所有--</option>
									<option value="1">单词</option>
									<option value="2">测试属性</option>
									<option value="3">防身</option>
								</select>
							</div>
						</div>
						<div class="layui-inline">
							<label class="layui-form-label">培训形式</label>
							<div class="layui-input-inline">
								<select name="trainForm" lay-verify="" lay-search="">
									<option value="">--所有--</option>
									<option value="1">内部培训</option>
									<option value="2">外部公开班</option>
									<option value="3">外聘内训</option>
								</select>
							</div>
						</div>
						<div class="layui-inline">
							<label class="layui-form-label">培训机构</label>
							<div class="layui-input-inline">
								<select name="" lay-verify="" lay-search="">
									<option value="">--所有--</option>
									<option value="1">强思企业管理</option>
									<option value="2">广州盛炬智能科技有限公司</option>
									<option value="3">若干</option>
								</select>
							</div>
						</div>
						<div class="layui-inline">
							<label class="layui-form-label">等效课程</label>
							<div class="layui-input-inline">
								<input type="text" name="" lay-verify="" placeholder="等效课程*" autocomplete="off" class="layui-input">
							</div>
						</div>
						<div class="layui-inline">
							<label class="layui-form-label">讲师姓名</label>
							<div class="layui-input-inline">
								<input type="text" name="teacherId" lay-verify="" placeholder="讲师姓名" autocomplete="off" class="layui-input">
							</div>
						</div>
						<div class="layui-inline">
							<label class="layui-form-label">培训开始</label>
							<div class="layui-input-inline">
								<input type="text" name="startTime" lay-verify="" placeholder="yyyy-mm-dd" autocomplete="off" class="layui-input date">
							</div>
						</div>
						<div class="layui-inline">
							<label class="layui-form-label">培训结束</label>
							<div class="layui-input-inline">
								<input type="text" name="endTime" lay-verify="" placeholder="yyyy-mm-dd" autocomplete="off" class="layui-input date">
							</div>
						</div>
						<div class="layui-card-body">
							<!--课程类型-->
							<script type="text/html" id="courseTypeName">
								{{#  
								if(d.courseTypeName==1){ }}USB{{#  } else 
								if(d.courseTypeName==6) { }}操作证{{#  } else 
								if(d.courseTypeName==10) { }}供应链管理{{#  } else 
								if(d.courseTypeName==11) { }}管理{{#  } else 
								if(d.courseTypeName==28) { }}基础{{#  } else 
								if(d.courseTypeName==30) { }}计算机{{#  } else 
								if(d.courseTypeName==51) { }}品质管理{{#  } else 
								{ }}
								{{#  } }}
		                    </script>
							<!--课程属性-->
							<script type="text/html" id="courseAttrId">
								{{#  if(d.courseAttrId==1){ }}
					        单词
							{{#  } else if(d.courseAttrId==2) { }}
							测试属性
							{{#  } else if(d.courseAttrId==3) { }}
							防身
							{{#  } else { }}
							{{#  } }}
							</script>
						</div>
					</div>


					<div class="layui-card-body">
						<div style="padding-bottom: 10px;">
							<button class="layui-btn layuiadmin-btn-list" data-type="">数据列表</button>
							<!-- 搜索按钮 -->
							<button class="layui-btn layuiadmin-btn-list" lay-submit lay-filter="LAY-app-contlist-search" data-type="reload">
								<i class="layui-icon layui-icon-search layuiadmin-button-btn"></i>查询
							</button>
						</div>
						<table id="LAY-report-general-train" lay-filter="LAY-report-general-train"></table>
					</div>


					<script>
						layui.use(['admin', 'contlist', 'table', 'form', 'laydate','element'], function() {
						var $ = layui.$,
						admin = layui.admin,
						view = layui.view,
						table = layui.table,
						laydate = layui.laydate,
						form = layui.form,
						element = layui.element;
						

				//表格渲染
				table.render({
						elem: '#LAY-report-general-train',
						method: "GET",
						url: commonSrc + "api/train/recordInController/trainRecord",
						toolbar: '#toolbarDemo',
						request: {
							pageName: 'pageNum' //页码的参数名称，默认：page
								,
							limitName: 'pageSize' //每页数据量的参数名，默认：limit
						},
						response: {
							statusCode: 200 //规定成功的状态码，默认：0
						},
						parseData: function(res) { //res 即为原始返回的数据
							return {
						"code": res.code, //解析接口状态
						"msg": res.desc, //解析提示文本
						"count": res.total, //解析数据长度
						"data": res.dataList //解析数据列表
						};
					},
					cols: [
					[{
						type: 'checkbox',
						fixed: "left"
					},{
						field: 'courseGrade',
						title: '满意度：对课程评估',
						hide: true,
					}, {
						field: 'courseName',
						title: '等效课程',
						align: 'center'
					}, {
						field: 'courseTypeName',
						title: '课程类型',
						toolbar: '#courseTypeName',
						align: 'center'
					}, {
						field: 'endTime',
						title: '结束日期',
						align: 'center'
					}, {
						field: 'gradeFive',
						title: '成绩5',
						hide: true,
					}, {
						field: 'gradeFour',
						title: '成绩4',
						hide: true,
					},{
						field: 'gradeOne',
						title: '成绩1',
						hide: true,
					},{
						field: 'gradeThree',
						title: '成绩3',
						hide: true,
					},{
						field: 'gradeTwo',
						title: '成绩2',
						hide: true,
					},{
						field: 'otherOne',
						title: '总其它1',
						hide: true,
					},{
						field: 'otherThree',
						title: '总其它3',
						hide: true,
					},{
						field: 'otherTwo',
						title: '总其它2',
						hide: true,
					}, {
						field: 'passedNum',
						title: '已通过人数',
						align: 'center'
					}, {
						field: 'place',
						title: '培训地点',
						align: 'center'
					}, {
						field: 'planClass ',
						title: '课时',
						align: 'center'
					},{
						field: 'startTime ',
						title: '开始日期',
						align: 'center'
					},{
						field: 'teacherName ',
						title: '讲师',
						align: 'center'
					},{
						field: 'trainedNum ',
						title: '已培训人数',
						align: 'center'
					},{
						field: 'travel ',
						title: '总差旅',
						align: 'center'
					}, {
						field: 'tuition',
						title: '总学费',
						align: 'center'
					}]
				],
				page: !0,
				limit: 10,
				limits: [10, 15, 20, 25, 30],
				// id:"testRload"
				}),
			
				form.render(null, 'app-content-list');
				
				// 监听搜索
				 active = {
				    reload: function(){
				      // var demoReload = $('#demoReload');
				      
				      //执行重载
				      table.reload('LAY-report-general-train', {
				        page: {
				          curr: 1 //重新从第 1 页开始
				        }
				        ,where: {
				          key: {
				            // teacherId:1
							 // startTime: "2019-09-05",
							  // endTime: "2019-09-06",
				          }
				        }
				      }, 'data');
				    }
				  };
				  ajax_courseType();
				  function ajax_courseType() {
				  			// 清空原有select内的数据  只保留第一项
				  			$("#courseType").find("option:not(:first)").remove();
				  			form.render('select', 'courseType');//渲染表单
				  			$.ajax({
				  				url: commonSrc + "/api/train/courseTypeController/list",
				  				type: "get",
				  				dataType: "json",
				  				success: function (res) {
				  					var data = res.dataList;
				  					$.each(data, function (i, v) {
				  						var id = v.id;
				  						var text = v.typeName;
				  						// alert(id + text);
				  						$("#courseType").append("<option value='" + id + "'>" + text + "</option>");
				  					});
				  					//渲染select 表单  filter 是 重新渲染对象
				  					form.render('select', 'app-content-list');
				  				},
				  				error: function () {
				  					// alert(errorThrown);
				  				}
				  			});
				  		}
				  
				  

				//监听搜索
				// form.on('submit(LAY-app-contlist-search)', function(data) {
				// 	var field = data.field;
				// 	console.log(field);
				// 	
				// 	//执行重载
				// 	table.reload('LAY-report-general-train', {
				// 		where: field,
				// 	});
				// });


				$('.layui-btn.layuiadmin-btn-list').on('click', function() {
					var type = $(this).data('type');
					active[type] ? active[type].call(this) : '';
				});
				
				//日期
				$(".date").each(function() {
					laydate.render({
						elem: this,
						trigger: 'click',
					});
					})
				
				})
				</script>
				</div>
				<!--讲师相关-->
				<div class="layui-tab-item">

					<div class="layui-form-item">
						<div class="layui-inline">
							<button class="layui-btn layuiadmin-btn-list">查询信息</button>
						</div>
					</div>

					<div class="layui-form-item">
						<div class="layui-inline">
							<label class="layui-form-label">课程类型</label>
							<div class="layui-input-inline">
								<input type="text" name="courseType" lay-verify="" placeholder="课程类型" autocomplete="off" class="layui-input">
							</div>
						</div>
						<div class="layui-inline">
							<label class="layui-form-label">课程属性</label>
							<div class="layui-input-inline">
								<select name="courseAttrId" lay-verify="" lay-search="">
									<option value="">--所有--</option>
									<option value="1">单词</option>
									<option value="2">测试属性</option>
									<option value="3">防身</option>
								</select>
							</div>
						</div>
						<div class="layui-inline">
							<label class="layui-form-label">培训形式</label>
							<div class="layui-input-inline">
								<select name="trainForm" lay-verify="" lay-search="">
									<option value="">--所有--</option>
									<option value="1">内部培训</option>
									<option value="2">外部公开班</option>
									<option value="3">外聘内训</option>
								</select>
							</div>
						</div>
						<div class="layui-inline">
							<label class="layui-form-label">培训机构</label>
							<div class="layui-input-inline">
								<select name="" lay-verify="" lay-search="">
									<option value="">--所有--</option>
									<option value="1">强思企业管理</option>
									<option value="2">广州盛炬智能科技有限公司</option>
									<option value="3">若干</option>
								</select>
							</div>
						</div>
						<div class="layui-inline">
							<label class="layui-form-label">等效课程</label>
							<div class="layui-input-inline">
								<input type="text" name="" lay-verify="" placeholder="等效课程*" autocomplete="off" class="layui-input">
							</div>
						</div>
						<div class="layui-inline">
							<label class="layui-form-label">讲师姓名</label>
							<div class="layui-input-inline">
								<select name="teacherId" lay-search=""  id="teacherId" lay-filter="teacherId">
									<option value="">--全部--</option>
									<option value="1">内部</option>
									<option value="2">外部</option>
								</select>
							</div>
						</div>
						<div class="layui-inline">
							<label class="layui-form-label">入职日期</label>
							<div class="layui-input-inline">
								<input type="text" name="startTime" lay-verify="" placeholder="yyyy-mm-dd" autocomplete="off" class="layui-input date">
							</div>
						</div>
						<div class="layui-inline">
							<label class="layui-form-label">离职日期</label>
							<div class="layui-input-inline">
								<input type="text" name="endTime" lay-verify="" placeholder="yyyy-mm-dd" autocomplete="off" class="layui-input date">
							</div>
						</div>
						<div class="layui-inline">
							<label class="layui-form-label">讲师类别</label>
							<div class="layui-input-inline">
								<select name="inside" lay-verify="">
									<option value="">--全部--</option>
									<option value="1">内部</option>
									<option value="2">外部</option>
								</select>
							</div>
						</div>
						<div class="layui-card-body">
							<script type="text/html" id="inside">
								{{#  if(d.checkStatus==1){ }}
								<button>保存</button>
								{{#  } else if(d.checkStatus==2) { }}
								<button>审核中</button>
								{{#  } else if(d.checkStatus==3) { }}
								<button>审核通过</button>
								{{#  } }}
							    </script>
						</div>


						<div class="layui-card-body">
							<div style="padding-bottom: 10px;">
								<button class="layui-btn layuiadmin-btn-list" data-type="">数据列表</button>
								<!-- 搜索按钮 -->
								<button class="layui-btn layuiadmin-btn-list" lay-submit lay-filter="LAY-app-contlist-search">
									<i class="layui-icon layui-icon-search layuiadmin-button-btn"></i>查询
								</button>
							</div>
							<table id="LAY-report-general-lecturer" lay-filter="LAY-report-general-lecturer"></table>
						</div>
					</div>

					<script>
						layui.use(['admin', 'contlist', 'table', 'form', 'laydate', 'element'], function() {
							var $ = layui.$,
								admin = layui.admin,
								view = layui.view,
								table = layui.table,
								laydate = layui.laydate,
								form = layui.form,
								element = layui.element;

							//表格渲染
							table.render({
									elem: '#LAY-report-general-lecturer',
									method: "GET",
									url: commonSrc + 'api/train/recordInController/teacherRelated',
									toolbar: '#toolbarDemo',
									request: {
										pageName: 'pageNum' //页码的参数名称，默认：page
											,
										limitName: 'pageSize' //每页数据量的参数名，默认：limit
									},
									response: {
										statusCode: 200 //规定成功的状态码，默认：0
									},
									parseData: function(res) { //res 即为原始返回的数据
										return {
											"code": res.code, //解析接口状态
											"msg": res.desc, //解析提示文本
											"count": res.total, //解析数据长度
											"data": res.dataList //解析数据列表
										};
									},
									cols: [
										[{
											type: 'checkbox',
											fixed: "left"
										}, {
											field: 'courseComment',
											title: '学员反馈：对课程的评语',
											hide: true,
										}, {
											field: 'courseName',
											title: '等效课程',
											align: 'center'
										}, {
											field: 'endTime',
											title: '结束日期',
											align: 'center'
										}, {
											field: 'otherName',
											title: '课程别名',
											align: 'center'
										}, {
											field: 'place',
											title: '培训地点',
											align: 'center'
										}, {
											field: 'planClass',
											title: '课时',
											align: 'center'
										}, {
											field: 'remark',
											title: '备注',
											hide: true,
										}, {
											field: 'startTime',
											title: '开始日期',
											align: 'center'
										}, {
											field: 'teacherGrade',
											title: '满意度：对老师的评分',
											hide: true,
										 }, 
										 {
											field: 'teacherName',
											title: '讲师',
											align: 'center'
										}
										]
									],
									page: !0,
									limit: 10,
									limits: [10, 15, 20, 25, 30],
								}),

								form.render(null, 'app-content-list');

							//监听搜索
							form.on('submit(LAY-app-contlist-search)', function(data) {
								var field = data.field;
								console.log(field);
								//执行重载
								table.reload('LAY-report-general-lecturer', {
									where: field
								});
							});
							
							ajax_teacher();
							function ajax_teacher() {
										// 清空原有select内的数据  只保留第一项
										$("#teacherId").find("option:not(:first)").remove();
										form.render('select', 'teacherId');//渲染表单
										$.ajax({
											url: commonSrc + "/api/train/teacherController/selectTeacherTypeById",
											type: "get",
											dataType: "json",
											success: function (res) {
												var data = res.dataList;
												$.each(data, function (i, v) {
													var id = v.id;
													var text = v.name;
													// alert(id + text);
													$("#teacherId").append("<option value='" + id + "'>" + text + "</option>");
												});
												//渲染select 表单  filter 是 重新渲染对象
												form.render('select', 'app-content-list');
											},
											error: function () {
												// alert(errorThrown);
											}
										});
									}


							// $('.layui-btn.layuiadmin-btn-list').on('click', function() {
							// 	var type = $(this).data('type');
							// 	active[type] ? active[type].call(this) : '';
							// });
							//日期
							$(".date").each(function() {
								laydate.render({
									elem: this,
									trigger: 'click',
								});
							})
							/*$(".add").click(function() {
								$("table").hide();
							});*/
						})
					</script>
				</div>
			</div>
		</div>
	</div>
